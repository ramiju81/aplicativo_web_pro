<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Funcionalidades - mySiss</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --mysiss-purple: #800080;
            --mysiss-light-purple: #EBE3F2;
            --mysiss-hover-purple: #DFD1EE;
            --mysiss-active-bg: #D0B8E6;
        }
        .custom-radio {
            accent-color: var(--mysiss-purple);
        }
        .focus-outline:focus-visible {
            outline: 2px solid var(--mysiss-purple);
            outline-offset: 2px;
        }
        /* Estilos para el sidebar */
        .submenu {
            display: none;
            padding-left: 1rem;
        }
        .submenu.active {
            display: block;
        }
        .nav-link.active {
            background-color: var(--mysiss-active-bg);
            font-weight: bold;
            position: relative;
        }
        .nav-link.active::after {
            content: "";
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background-color: var(--mysiss-purple);
        }
        .rotate-180 {
            transform: rotate(180deg);
        }
        /* Estilo para el contenedor del menú */
        nav {
            display: flex;
            flex-direction: column;
            height: calc(100% - 80px); /* Ajustar según altura del logo */
            position: relative;
        }
        /* Estilo para el enlace de cerrar sesión */
        .logout-link {
            margin-top: auto; /* Empuja el enlace hacia abajo */
            position: sticky;
            bottom: 0;
            background-color: var(--mysiss-light-purple);
            padding-top: 10px;
            padding-bottom: 10px;
        }

        .custom-radio {
            accent-color: var(--mysiss-purple);
        }
        .focus-outline:focus-visible {
            outline: 2px solid var(--mysiss-purple);
            outline-offset: 2px;
        }
        .file-input {
            display: none;
        }
        .btn-disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .table-row-inactive {
            background-color: #f3f4f6;
            color: #6b7280;
        }
        .table-row-active {
            background-color: white;
        }
        .selected-row {
            background-color: #DFD1EE;
        }
        .disabled-field {
            background-color: #f3f4f6;
            color: #6b7280;
        }
    </style>
</head>
<body class="flex h-screen w-full overflow-hidden">
    <!-- Sidebar -->
    <div class="w-48 h-full bg-[var(--mysiss-light-purple)] flex flex-col">
        <div class="p-6">
            <h1 class="text-[var(--mysiss-purple)] text-5xl font-bold">mySiss</h1>
        </div>
        <nav class="mt-4 flex flex-col" aria-label="Menú principal">
            <!-- Configuración -->
            <!-- Configuración -->
            <div class="menu-item">
                <a href="#" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline flex justify-between items-center" onclick="toggleSubmenu('config-submenu', this)">
                    <strong>Configuración</strong>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transform transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </a>
                <div id="config-submenu" class="submenu">
                    <a href="conf_bas_1.html" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline block">Base</a>
                    <a href="conf_func_1.html" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline block">Funcionalidad</a>
                    <a href="conf_role.html" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline block">Roles</a>
                </div>
            </div>
            
            <!-- Usuario -->
            <div class="menu-item">
                <a href="#" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline flex justify-between items-center" onclick="toggleSubmenu('usuario-submenu', this)">
                    <strong>Usuario</strong>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transform transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </a>
                <div id="usuario-submenu" class="submenu">
                    <a href="conf_usua_1.html" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline block">Creación user</a>
                    <a href="conf_rol.html" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline block">User rol</a>
                </div>
            </div>
            
            <!-- Módulos - Estructura de tres niveles -->
            <div class="menu-item">
                <a href="#" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline flex justify-between items-center" onclick="toggleSubmenu('modulos-submenu', this)">
                    <strong>Modulos</strong>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transform transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </a>
                <div id="modulos-submenu" class="submenu">
                    <!-- Honorarios -->
                    <div class="menu-item">
                        <a href="#" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline flex justify-between items-center" onclick="toggleSubmenu('honorarios-submenu', this)">
                            <span>Honorarios</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transform transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                            </svg>
                        </a>
                        <div id="honorarios-submenu" class="submenu">
                            <a href="../Honorarios/configuracion.html" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline block">Configuración</a>
                            <a href="../Honorarios/Honorarios.html" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline block">Proceso</a>
                        </div>
                    </div>
                    
                    <!-- Auditoria -->
                    <div class="menu-item">
                        <a href="#" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline flex justify-between items-center" onclick="toggleSubmenu('auditoria-submenu', this)">
                            <span>Auditoria</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transform transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                            </svg>
                        </a>
                        <div id="auditoria-submenu" class="submenu">
                            <a href="../auditoria/configuracion.html" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline block">Configuración</a>
                            <a href="../auditoria/auditoria.html" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline block">Proceso</a>
                        </div>
                    </div>
                    
                    <!-- Glosas -->
                    <div class="menu-item">
                        <a href="#" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline flex justify-between items-center" onclick="toggleSubmenu('glosas-submenu', this)">
                            <span>Glosas</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transform transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                            </svg>
                        </a>
                        <div id="glosas-submenu" class="submenu">
                            <a href="../glosas/configuracion.html" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline block">Configuración</a>
                            <a href="../glosas/glosas.html" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors focus-outline block">Proceso</a>
                        </div>
                    </div>
                </div>
            </div>
            <a href="../login.html" class="nav-link py-2 px-6 text-[var(--mysiss-purple)] hover:bg-[var(--mysiss-hover-purple)] transition-colors mt-44 focus-outline">
                <strong>Cerrar Sesión</strong>
            </a>
        </nav>
    </div>

    <!-- Contenido principal -->
    <div class="flex-1 bg-white p-8 overflow-auto">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-[var(--mysiss-purple)]">Funcionalidades</h2>
            <button id="nextBtn" class="btn-disabled px-4 py-2 bg-[var(--mysiss-purple)] text-white rounded-md focus-outline">
                Siguiente
            </button>
        </div>

        <!-- Pestañas -->
        <div class="mb-8 border-b border-gray-200">
            <ul class="flex flex-wrap -mb-px" id="tabs" role="tablist">
                <li class="mr-2" role="presentation">
                    <button class="inline-block p-4 border-b-2 rounded-t-lg" id="carga-tab" data-tabs-target="#carga" type="button" role="tab" aria-controls="carga" aria-selected="true">Carga plantilla</button>
                </li>
                <li class="mr-2" role="presentation">
                    <button class="inline-block p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300" id="modulos-tab" data-tabs-target="#modulos" type="button" role="tab" aria-controls="modulos" aria-selected="false">Módulos</button>
                </li>
                <li class="mr-2" role="presentation">
                    <button class="inline-block p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300" id="funcionalidades-tab" data-tabs-target="#funcionalidades" type="button" role="tab" aria-controls="funcionalidades" aria-selected="false">Funcionalidades</button>
                </li>
                <li role="presentation">
                    <button class="inline-block p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300" id="actividades-tab" data-tabs-target="#actividades" type="button" role="tab" aria-controls="actividades" aria-selected="false">Actividades</button>
                </li>
            </ul>
        </div>

        <!-- Contenido de pestañas -->
        <div id="tab-content">
            <!-- Pestaña Carga plantilla -->
            <div class="hidden p-4 rounded-lg bg-gray-50" id="carga" role="tabpanel" aria-labelledby="carga-tab">
                <div class="max-w-2xl mx-auto">
                    <fieldset class="space-y-4 mb-8">
                        <legend class="text-lg font-semibold text-gray-700 mb-4">Tipo de carga</legend>
                        
                        <div class="flex items-center space-x-6">
                            <div class="flex items-center">
                                <input type="radio" id="inicial" name="tipoCarga" class="custom-radio w-4 h-4 focus-outline" checked>
                                <label for="inicial" class="ml-2 text-lg text-gray-700">Inicial</label>
                            </div>
                            
                            <div class="flex items-center">
                                <input type="radio" id="actualizacion" name="tipoCarga" class="custom-radio w-4 h-4 focus-outline">
                                <label for="actualizacion" class="ml-2 text-lg text-gray-700">Actualización</label>
                            </div>
                        </div>
                    </fieldset>

                    <div class="mb-8">
                        <label for="fileInput" class="block text-lg font-medium text-gray-700 mb-2"></label>
                        <div class="flex">
                            <input type="text" id="filePath" class="flex-1 border border-gray-300 rounded-md px-3 py-2 focus-outline cursor-pointer" 
                                placeholder="Seleccionar archivo..." readonly onclick="document.getElementById('fileInput').click()">
                            <input type="file" id="fileInput" class="file-input" accept=".xlsx">
                        </div>
                        <p class="mt-1 text-sm text-gray-500">Seleccione un archivo en formato .XLSX</p>
                    </div>

                    <button id="executeBtn" class="btn-disabled w-32 py-2 bg-[var(--mysiss-purple)] text-white rounded-md focus-outline">
                        Ejecutar
                    </button>
                </div>
            </div>

            <!-- Pestaña Módulos -->
            <div class="hidden p-4 rounded-lg bg-gray-50" id="modulos" role="tabpanel" aria-labelledby="modulos-tab">
                <div class="overflow-x-auto">
                    <div class="flex justify-end space-x-2 mb-4">
                        <button id="insertLineBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Insertar línea</button>
                        <button id="deleteLineBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Borrar línea</button>
                        <button id="viewBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Visualizar</button>
                        <button id="createBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Crear</button>
                        <button id="editBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Modificar</button>
                        <button id="saveBtn" class="px-3 py-1 bg-[var(--mysiss-purple)] text-white rounded-md focus-outline">Guardar</button>
                        <button id="backBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Atrás</button>
                    </div>
                    
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">COD.Módulos</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Módulos</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha creación</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha modificación</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Creado por</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Modificado por</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200" id="modulosTableBody">
                            <!-- Filas se generan dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Pestaña Funcionalidades -->
            <div class="hidden p-4 rounded-lg bg-gray-50" id="funcionalidades" role="tabpanel" aria-labelledby="funcionalidades-tab">
                <div class="overflow-x-auto">
                    <div class="flex justify-end space-x-2 mb-4">
                        <button id="insertFuncBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Insertar línea</button>
                        <button id="deleteFuncBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Borrar línea</button>
                        <button id="viewFuncBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Visualizar</button>
                        <button id="createFuncBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Crear</button>
                        <button id="editFuncBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Modificar</button>
                        <button id="saveFuncBtn" class="px-3 py-1 bg-[var(--mysiss-purple)] text-white rounded-md focus-outline">Guardar</button>
                        <button id="backFuncBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Atrás</button>
                    </div>
                    
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">COD.Funcionalidades</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Funcionalidades</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha creación</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha modificación</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Creado por</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Modificado por</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200" id="funcionalidadesTableBody">
                            <tr class="table-row-inactive">
                                <td class="px-6 py-4 whitespace-nowrap">FH001</td>
                                <td class="px-6 py-4 whitespace-nowrap">Preliquidación</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                            </tr>
                            <tr class="table-row-inactive">
                                <td class="px-6 py-4 whitespace-nowrap">FH002</td>
                                <td class="px-6 py-4 whitespace-nowrap">Validaciones</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                            </tr>
                            <tr class="table-row-inactive">
                                <td class="px-6 py-4 whitespace-nowrap">FH003</td>
                                <td class="px-6 py-4 whitespace-nowrap">Reporte</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                            </tr>
                            <tr class="table-row-inactive">
                                <td class="px-6 py-4 whitespace-nowrap">FH004</td>
                                <td class="px-6 py-4 whitespace-nowrap">Liquidación</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                            </tr>
                            <tr class="table-row-inactive">
                                <td class="px-6 py-4 whitespace-nowrap">FG001</td>
                                <td class="px-6 py-4 whitespace-nowrap">Radicación de facturas</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                            </tr>
                            <tr class="table-row-inactive">
                                <td class="px-6 py-4 whitespace-nowrap">FG002</td>
                                <td class="px-6 py-4 whitespace-nowrap">Devolución de facturas</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                            </tr>
                            <tr class="table-row-inactive">
                                <td class="px-6 py-4 whitespace-nowrap">FG003</td>
                                <td class="px-6 py-4 whitespace-nowrap">Cargue de objeciones</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                            </tr>
                            <tr class="table-row-inactive">
                                <td class="px-6 py-4 whitespace-nowrap">FG004</td>
                                <td class="px-6 py-4 whitespace-nowrap">Gestión objeciones y glosa</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                            </tr>
                            <tr class="table-row-inactive">
                                <td class="px-6 py-4 whitespace-nowrap">FG005</td>
                                <td class="px-6 py-4 whitespace-nowrap">Conciliación objeciones</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">27.02.2025</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                                <td class="px-6 py-4 whitespace-nowrap disabled-field">Duarca</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Pestaña Actividades -->
            <div class="hidden p-4 rounded-lg bg-gray-50" id="actividades" role="tabpanel" aria-labelledby="actividades-tab">
                <div class="overflow-x-auto">
                    <div class="flex justify-end space-x-2 mb-4">
                        <button id="insertActBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Insertar línea</button>
                        <button id="deleteActBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Borrar línea</button>
                        <button id="viewActBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Visualizar</button>
                        <button id="createActBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Crear</button>
                        <button id="editActBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Modificar</button>
                        <button id="saveActBtn" class="px-3 py-1 bg-[var(--mysiss-purple)] text-white rounded-md focus-outline">Guardar</button>
                        <button id="backActBtn" class="px-3 py-1 bg-gray-200 rounded-md focus-outline">Atrás</button>
                    </div>
                    
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">COD.Actividades</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actividades</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha creación</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha modificación</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Creado por</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Modificado por</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200" id="actividadesTableBody">
                            <!-- Filas se generan dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para mensajes -->
    <div id="messageModal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center">
        <div class="bg-white p-6 rounded-lg max-w-md w-full">
            <h3 id="modalTitle" class="text-lg font-bold mb-4"></h3>
            <p id="modalMessage" class="mb-4"></p>
            <div class="flex justify-end">
                <button id="modalCloseBtn" class="px-4 py-2 bg-[var(--mysiss-purple)] text-white rounded-md focus-outline">
                    Cerrar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal para búsqueda -->
    <div id="searchModal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center">
        <div class="bg-white p-6 rounded-lg max-w-2xl w-full">
            <h3 id="searchModalTitle" class="text-lg font-bold mb-4"></h3>
            <div class="mb-4">
                <input type="text" id="searchInput" class="border border-gray-300 rounded-md px-3 py-2 w-full focus-outline" placeholder="Buscar...">
            </div>
            <div class="max-h-96 overflow-y-auto mb-4">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Código</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nombre</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Seleccionar</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200" id="searchResults">
                        <!-- Resultados de búsqueda -->
                    </tbody>
                </table>
            </div>
            <div class="flex justify-end">
                <button id="searchModalCloseBtn" class="px-4 py-2 bg-[var(--mysiss-purple)] text-white rounded-md focus-outline">
                    Cerrar
                </button>
            </div>
        </div>
    </div>

<script>
    // Datos almacenados en localStorage
    let modulosData = JSON.parse(localStorage.getItem('modulosData')) || [
        { codigo: 'MH001', nombre: 'Honorarios', fechaCreacion: '27.02.2025', fechaModificacion: '27.02.2025', creadoPor: 'Duarca', modificadoPor: 'Duarca' },
        { codigo: 'MG001', nombre: 'Glosas', fechaCreacion: '27.02.2025', fechaModificacion: '27.02.2025', creadoPor: 'Duarca', modificadoPor: 'Duarca' },
        { codigo: 'MA001', nombre: 'Auditoría Calidad', fechaCreacion: '27.02.2025', fechaModificacion: '27.02.2025', creadoPor: 'Duarca', modificadoPor: 'Duarca' },
        { codigo: 'MA002', nombre: 'Auditoría Concurrente', fechaCreacion: '27.02.2025', fechaModificacion: '27.02.2025', creadoPor: 'Duarca', modificadoPor: 'Duarca' },
        { codigo: 'MA003', nombre: 'Auditoría Cuentas Médicas', fechaCreacion: '27.02.2025', fechaModificacion: '27.02.2025', creadoPor: 'Duarca', modificadoPor: 'Duarca' }
    ];

    let funcionalidadesData = JSON.parse(localStorage.getItem('funcionalidadesData')) || [
        { codigo: 'FH001', nombre: 'Preliquidación', fechaCreacion: '27.02.2025', fechaModificacion: '27.02.2025', creadoPor: 'Duarca', modificadoPor: 'Duarca' },
        { codigo: 'FH002', nombre: 'Validaciones', fechaCreacion: '27.02.2025', fechaModificacion: '27.02.2025', creadoPor: 'Duarca', modificadoPor: 'Duarca' },
        { codigo: 'FH003', nombre: 'Reporte', fechaCreacion: '27.02.2025', fechaModificacion: '27.02.2025', creadoPor: 'Duarca', modificadoPor: 'Duarca' },
        { codigo: 'FH004', nombre: 'Liquidación', fechaCreacion: '27.02.2025', fechaModificacion: '27.02.2025', creadoPor: 'Duarca', modificadoPor: 'Duarca' },
        { codigo: 'FG001', nombre: 'Radicación de facturas', fechaCreacion: '27.02.2025', fechaModificacion: '27.02.2025', creadoPor: 'Duarca', modificadoPor: 'Duarca' },
        { codigo: 'FG002', nombre: 'Devolución de facturas', fechaCreacion: '27.02.2025', fechaModificacion: '27.02.2025', creadoPor: 'Duarca', modificadoPor: 'Duarca' },
        { codigo: 'FG003', nombre: 'Cargue de objeciones', fechaCreacion: '27.02.2025', fechaModificacion: '27.02.2025', creadoPor: 'Duarca', modificadoPor: 'Duarca' },
        { codigo: 'FG004', nombre: 'Gestión objeciones y glosa', fechaCreacion: '27.02.2025', fechaModificacion: '27.02.2025', creadoPor: 'Duarca', modificadoPor: 'Duarca' },
        { codigo: 'FG005', nombre: 'Conciliación objeciones', fechaCreacion: '27.02.2025', fechaModificacion: '27.02.2025', creadoPor: 'Duarca', modificadoPor: 'Duarca' }
    ];

    let actividadesData = JSON.parse(localStorage.getItem('actividadesData')) || [];

    // Variables de estado
    let selectedRow = null;
    let selectedFuncRow = null;
    let selectedActRow = null;
    let isCreating = false;
    let isEditing = false;
    let currentUser = 'Duarca'; // Usuario actual (debería venir de la sesión)

    // Inicializar tablas
    document.addEventListener('DOMContentLoaded', () => {
        renderModulosTable();
        renderFuncionalidadesTable();
        renderActividadesTable();
        setActiveMenu();
        initializeTabs();
        expandAllMenus(); // Nueva función para expandir todos los menús
    });

    // Función para expandir todos los menús y submenús
    function expandAllMenus() {
        // Mostrar todos los submenús principales
        document.querySelectorAll('.submenu').forEach(menu => {
            menu.classList.add('active');
        });
        
        // Rotar todas las flechas
        document.querySelectorAll('.menu-item > a svg').forEach(icon => {
            icon.classList.add('rotate-180');
        });
    }

    // Manejo de pestañas
    function initializeTabs() {
        const tabs = document.querySelectorAll('[role="tab"]');
        const tabPanels = document.querySelectorAll('[role="tabpanel"]');

        tabs.forEach(tab => {
            tab.addEventListener('click', (e) => {
                e.preventDefault();
                
                // Desactivar todas las pestañas
                tabs.forEach(t => {
                    t.setAttribute('aria-selected', 'false');
                    t.classList.remove('border-[var(--mysiss-purple)]', 'text-[var(--mysiss-purple)]');
                    t.classList.add('border-transparent');
                });
                
                // Activar la pestaña clickeada
                tab.setAttribute('aria-selected', 'true');
                tab.classList.add('border-[var(--mysiss-purple)]', 'text-[var(--mysiss-purple)]');
                tab.classList.remove('border-transparent');
                
                // Ocultar todos los paneles
                tabPanels.forEach(panel => {
                    panel.classList.add('hidden');
                });
                
                // Mostrar el panel correspondiente
                const panelId = tab.getAttribute('data-tabs-target');
                document.querySelector(panelId).classList.remove('hidden');
                
                // Mostrar el botón Siguiente si no estamos en actividades
                const nextBtn = document.getElementById('nextBtn');
                if (tab.id !== 'actividades-tab') {
                    nextBtn.style.display = '';
                    nextBtn.classList.add('btn-disabled');
                } else {
                    nextBtn.style.display = 'none';
                }
            });
        });

        // Activar la primera pestaña por defecto
        tabs[0].click();
    }

    // Manejo de carga de archivo
    const fileInput = document.getElementById('fileInput');
    const filePath = document.getElementById('filePath');
    const executeBtn = document.getElementById('executeBtn');
    const nextBtn = document.getElementById('nextBtn');

    fileInput.addEventListener('change', (e) => {
        if (e.target.files.length > 0) {
            const file = e.target.files[0];
            filePath.value = file.name;
            
            // Validar extensión del archivo
            if (!file.name.endsWith('.xlsx')) {
                showModal('Error', 'Archivo subido diferente a .XLSX.');
                executeBtn.classList.add('btn-disabled');
                return;
            }
            
            executeBtn.classList.remove('btn-disabled');
        }
    });

    executeBtn.addEventListener('click', () => {
        if (executeBtn.classList.contains('btn-disabled')) return;
        
        // Simular ejecución exitosa
        const tipoCarga = document.querySelector('input[name="tipoCarga"]:checked').id;
        const message = tipoCarga === 'inicial' 
            ? 'Carga inicial realizada correctamente.' 
            : 'Actualización realizada correctamente.';
        
        showModal('Éxito', 'Los datos fueron grabados correctamente');
        nextBtn.classList.remove('btn-disabled');
        
        // Limpiar campo de archivo después de ejecutar
        fileInput.value = '';
        filePath.value = '';
        executeBtn.classList.add('btn-disabled');
    });

    nextBtn.addEventListener('click', () => {
        if (!nextBtn.classList.contains('btn-disabled')) {
            // Determinar a qué pestaña ir según la actual
            const currentTab = document.querySelector('[role="tab"][aria-selected="true"]');
            
            if (currentTab.id === 'carga-tab') {
                document.getElementById('modulos-tab').click();
                nextBtn.classList.remove('btn-disabled');
            } else if (currentTab.id === 'modulos-tab') {
                document.getElementById('funcionalidades-tab').click();
                nextBtn.classList.remove('btn-disabled');
            } else if (currentTab.id === 'funcionalidades-tab') {
                document.getElementById('actividades-tab').click();
                nextBtn.style.display = 'none';
            }
        }
    });

    // Funciones para renderizar tablas
    function renderModulosTable() {
        const tableBody = document.getElementById('modulosTableBody');
        tableBody.innerHTML = '';
        
        modulosData.forEach((modulo, index) => {
            const row = document.createElement('tr');
            row.className = 'table-row-inactive';
            row.dataset.id = index;
            
            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap">${modulo.codigo}</td>
                <td class="px-6 py-4 whitespace-nowrap">${modulo.nombre}</td>
                <td class="px-6 py-4 whitespace-nowrap disabled-field">${modulo.fechaCreacion}</td>
                <td class="px-6 py-4 whitespace-nowrap disabled-field">${modulo.fechaModificacion}</td>
                <td class="px-6 py-4 whitespace-nowrap disabled-field">${modulo.creadoPor}</td>
                <td class="px-6 py-4 whitespace-nowrap disabled-field">${modulo.modificadoPor}</td>
            `;
            
            row.addEventListener('click', () => {
                if (!isCreating && !isEditing) {
                    document.querySelectorAll('#modulosTableBody tr').forEach(r => {
                        r.classList.remove('selected-row');
                    });
                    row.classList.add('selected-row');
                    selectedRow = index;
                }
            });
            
            tableBody.appendChild(row);
        });
    }

    function renderFuncionalidadesTable() {
        const tableBody = document.getElementById('funcionalidadesTableBody');
        tableBody.innerHTML = '';
        
        funcionalidadesData.forEach((func, index) => {
            const row = document.createElement('tr');
            row.className = 'table-row-inactive';
            row.dataset.id = index;
            
            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap">${func.codigo}</td>
                <td class="px-6 py-4 whitespace-nowrap">${func.nombre}</td>
                <td class="px-6 py-4 whitespace-nowrap disabled-field">${func.fechaCreacion}</td>
                <td class="px-6 py-4 whitespace-nowrap disabled-field">${func.fechaModificacion}</td>
                <td class="px-6 py-4 whitespace-nowrap disabled-field">${func.creadoPor}</td>
                <td class="px-6 py-4 whitespace-nowrap disabled-field">${func.modificadoPor}</td>
            `;
            
            row.addEventListener('click', () => {
                if (!isCreating && !isEditing) {
                    document.querySelectorAll('#funcionalidadesTableBody tr').forEach(r => {
                        r.classList.remove('selected-row');
                    });
                    row.classList.add('selected-row');
                    selectedFuncRow = index;
                }
            });
            
            tableBody.appendChild(row);
        });
    }

    function renderActividadesTable() {
        const tableBody = document.getElementById('actividadesTableBody');
        tableBody.innerHTML = '';
        
        actividadesData.forEach((act, index) => {
            const row = document.createElement('tr');
            row.className = 'table-row-inactive';
            row.dataset.id = index;
            
            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap">${act.codigo}</td>
                <td class="px-6 py-4 whitespace-nowrap">${act.nombre}</td>
                <td class="px-6 py-4 whitespace-nowrap disabled-field">${act.fechaCreacion}</td>
                <td class="px-6 py-4 whitespace-nowrap disabled-field">${act.fechaModificacion}</td>
                <td class="px-6 py-4 whitespace-nowrap disabled-field">${act.creadoPor}</td>
                <td class="px-6 py-4 whitespace-nowrap disabled-field">${act.modificadoPor}</td>
            `;
            
            row.addEventListener('click', () => {
                if (!isCreating && !isEditing) {
                    document.querySelectorAll('#actividadesTableBody tr').forEach(r => {
                        r.classList.remove('selected-row');
                    });
                    row.classList.add('selected-row');
                    selectedActRow = index;
                }
            });
            
            tableBody.appendChild(row);
        });
    }

    // Funciones para botones de módulos
    document.getElementById('insertLineBtn').addEventListener('click', () => {
        isCreating = true;
        selectedRow = null;
        
        const tableBody = document.getElementById('modulosTableBody');
        const newRow = document.createElement('tr');
        newRow.className = 'table-row-active';
        newRow.dataset.id = 'new';
        
        newRow.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value=""></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value=""></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
        `;
        
        tableBody.prepend(newRow);
    });

    document.getElementById('deleteLineBtn').addEventListener('click', () => {
        if (selectedRow !== null) {
            modulosData.splice(selectedRow, 1);
            localStorage.setItem('modulosData', JSON.stringify(modulosData));
            renderModulosTable();
            showModal('Éxito', 'Registro eliminado exitosamente');
            selectedRow = null;
        } else {
            showModal('Error', 'Por favor seleccione un registro para eliminar');
        }
    });

    document.getElementById('viewBtn').addEventListener('click', () => {
        if (selectedRow !== null) {
            const modulo = modulosData[selectedRow];
            showModal('Detalle del Módulo', 
                `Código: ${modulo.codigo}<br>
                Nombre: ${modulo.nombre}<br>
                Fecha Creación: ${modulo.fechaCreacion}<br>
                Fecha Modificación: ${modulo.fechaModificacion}<br>
                Creado por: ${modulo.creadoPor}<br>
                Modificado por: ${modulo.modificadoPor}`);
        } else {
            showModal('Error', 'Por favor seleccione un registro para visualizar');
        }
    });

    document.getElementById('createBtn').addEventListener('click', () => {
        isCreating = true;
        selectedRow = null;
        
        const tableBody = document.getElementById('modulosTableBody');
        const newRow = document.createElement('tr');
        newRow.className = 'table-row-active';
        newRow.dataset.id = 'new';
        
        newRow.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value=""></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value=""></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
        `;
        
        tableBody.prepend(newRow);
    });

    document.getElementById('editBtn').addEventListener('click', () => {
        if (selectedRow !== null) {
            isEditing = true;
            const modulo = modulosData[selectedRow];
            
            const tableBody = document.getElementById('modulosTableBody');
            const rows = tableBody.querySelectorAll('tr');
            const row = rows[selectedRow];
            row.className = 'table-row-active';
            
            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value="${modulo.codigo}"></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value="${modulo.nombre}"></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${modulo.fechaCreacion}" readonly></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${modulo.creadoPor}" readonly></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
            `;
        } else {
            showModal('Error', 'Por favor seleccione un registro para modificar');
        }
    });

    document.getElementById('saveBtn').addEventListener('click', () => {
        const tableBody = document.getElementById('modulosTableBody');
        const activeRow = tableBody.querySelector('.table-row-active');
        
        if (activeRow) {
            const inputs = activeRow.querySelectorAll('input');
            const newModulo = {
                codigo: inputs[0].value,
                nombre: inputs[1].value,
                fechaCreacion: inputs[2].value,
                fechaModificacion: inputs[3].value,
                creadoPor: inputs[4].value,
                modificadoPor: inputs[5].value
            };
            
            if (!newModulo.codigo || !newModulo.nombre) {
                showModal('Error', 'Los campos Código y Nombre son obligatorios');
                return;
            }
            
            if (isCreating) {
                modulosData.unshift(newModulo);
                showModal('Éxito', 'Se agregó registro exitosamente');
            } else if (isEditing) {
                modulosData[selectedRow] = newModulo;
                showModal('Éxito', 'Se modificó registro exitosamente');
            }
            
            localStorage.setItem('modulosData', JSON.stringify(modulosData));
            isCreating = false;
            isEditing = false;
            selectedRow = null;
            renderModulosTable();
        }
    });

    document.getElementById('backBtn').addEventListener('click', () => {
        document.getElementById('carga-tab').click();
    });

    // Funciones para botones de funcionalidades
    document.getElementById('insertFuncBtn').addEventListener('click', () => {
        isCreating = true;
        selectedFuncRow = null;
        
        const tableBody = document.getElementById('funcionalidadesTableBody');
        const newRow = document.createElement('tr');
        newRow.className = 'table-row-active';
        newRow.dataset.id = 'new';
        
        newRow.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value=""></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value=""></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
        `;
        
        tableBody.prepend(newRow);
    });

    document.getElementById('deleteFuncBtn').addEventListener('click', () => {
        if (selectedFuncRow !== null) {
            funcionalidadesData.splice(selectedFuncRow, 1);
            localStorage.setItem('funcionalidadesData', JSON.stringify(funcionalidadesData));
            renderFuncionalidadesTable();
            showModal('Éxito', 'Registro eliminado exitosamente');
            selectedFuncRow = null;
        } else {
            showModal('Error', 'Por favor seleccione un registro para eliminar');
        }
    });

    document.getElementById('viewFuncBtn').addEventListener('click', () => {
        if (selectedFuncRow !== null) {
            const func = funcionalidadesData[selectedFuncRow];
            showModal('Detalle de la Funcionalidad', 
                `Código: ${func.codigo}<br>
                Nombre: ${func.nombre}<br>
                Fecha Creación: ${func.fechaCreacion}<br>
                Fecha Modificación: ${func.fechaModificacion}<br>
                Creado por: ${func.creadoPor}<br>
                Modificado por: ${func.modificadoPor}`);
        } else {
            showModal('Error', 'Por favor seleccione un registro para visualizar');
        }
    });

    document.getElementById('createFuncBtn').addEventListener('click', () => {
        isCreating = true;
        selectedFuncRow = null;
        
        const tableBody = document.getElementById('funcionalidadesTableBody');
        const newRow = document.createElement('tr');
        newRow.className = 'table-row-active';
        newRow.dataset.id = 'new';
        
        newRow.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value=""></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value=""></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
        `;
        
        tableBody.prepend(newRow);
    });

    document.getElementById('editFuncBtn').addEventListener('click', () => {
        if (selectedFuncRow !== null) {
            isEditing = true;
            const func = funcionalidadesData[selectedFuncRow];
            
            const tableBody = document.getElementById('funcionalidadesTableBody');
            const rows = tableBody.querySelectorAll('tr');
            const row = rows[selectedFuncRow];
            row.className = 'table-row-active';
            
            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value="${func.codigo}"></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value="${func.nombre}"></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${func.fechaCreacion}" readonly></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${func.creadoPor}" readonly></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
            `;
        } else {
            showModal('Error', 'Por favor seleccione un registro para modificar');
        }
    });

    document.getElementById('saveFuncBtn').addEventListener('click', () => {
        const tableBody = document.getElementById('funcionalidadesTableBody');
        const activeRow = tableBody.querySelector('.table-row-active');
        
        if (activeRow) {
            const inputs = activeRow.querySelectorAll('input');
            const newFunc = {
                codigo: inputs[0].value,
                nombre: inputs[1].value,
                fechaCreacion: inputs[2].value,
                fechaModificacion: inputs[3].value,
                creadoPor: inputs[4].value,
                modificadoPor: inputs[5].value
            };
            
            if (!newFunc.codigo || !newFunc.nombre) {
                showModal('Error', 'Los campos Código y Nombre son obligatorios');
                return;
            }
            
            if (isCreating) {
                funcionalidadesData.unshift(newFunc);
                showModal('Éxito', 'Se agregó registro exitosamente');
            } else if (isEditing) {
                funcionalidadesData[selectedFuncRow] = newFunc;
                showModal('Éxito', 'Se modificó registro exitosamente');
            }
            
            localStorage.setItem('funcionalidadesData', JSON.stringify(funcionalidadesData));
            isCreating = false;
            isEditing = false;
            selectedFuncRow = null;
            renderFuncionalidadesTable();
        }
    });

    document.getElementById('backFuncBtn').addEventListener('click', () => {
        document.getElementById('modulos-tab').click();
    });

    // Funciones para botones de actividades
    document.getElementById('insertActBtn').addEventListener('click', () => {
        isCreating = true;
        selectedActRow = null;
        
        const tableBody = document.getElementById('actividadesTableBody');
        const newRow = document.createElement('tr');
        newRow.className = 'table-row-active';
        newRow.dataset.id = 'new';
        
        newRow.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value=""></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value=""></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
        `;
        
        tableBody.prepend(newRow);
    });

    document.getElementById('deleteActBtn').addEventListener('click', () => {
        if (selectedActRow !== null) {
            actividadesData.splice(selectedActRow, 1);
            localStorage.setItem('actividadesData', JSON.stringify(actividadesData));
            renderActividadesTable();
            showModal('Éxito', 'Registro eliminado exitosamente');
            selectedActRow = null;
        } else {
            showModal('Error', 'Por favor seleccione un registro para eliminar');
        }
    });

    document.getElementById('viewActBtn').addEventListener('click', () => {
        if (selectedActRow !== null) {
            const act = actividadesData[selectedActRow];
            showModal('Detalle de la Actividad', 
                `Código: ${act.codigo}<br>
                Nombre: ${act.nombre}<br>
                Fecha Creación: ${act.fechaCreacion}<br>
                Fecha Modificación: ${act.fechaModificacion}<br>
                Creado por: ${act.creadoPor}<br>
                Modificado por: ${act.modificadoPor}`);
        } else {
            showModal('Error', 'Por favor seleccione un registro para visualizar');
        }
    });

    document.getElementById('createActBtn').addEventListener('click', () => {
        isCreating = true;
        selectedActRow = null;
        
        const tableBody = document.getElementById('actividadesTableBody');
        const newRow = document.createElement('tr');
        newRow.className = 'table-row-active';
        newRow.dataset.id = 'new';
        
        newRow.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value=""></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value=""></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
            <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
        `;
        
        tableBody.prepend(newRow);
    });

    document.getElementById('editActBtn').addEventListener('click', () => {
        if (selectedActRow !== null) {
            isEditing = true;
            const act = actividadesData[selectedActRow];
            
            const tableBody = document.getElementById('actividadesTableBody');
            const rows = tableBody.querySelectorAll('tr');
            const row = rows[selectedActRow];
            row.className = 'table-row-active';
            
            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value="${act.codigo}"></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline" value="${act.nombre}"></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${act.fechaCreacion}" readonly></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${new Date().toLocaleDateString('de-DE')}" readonly></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${act.creadoPor}" readonly></td>
                <td class="px-6 py-4 whitespace-nowrap"><input type="text" class="border border-gray-300 rounded-md px-2 py-1 w-full focus-outline disabled-field" value="${currentUser}" readonly></td>
            `;
        } else {
            showModal('Error', 'Por favor seleccione un registro para modificar');
        }
    });

    document.getElementById('saveActBtn').addEventListener('click', () => {
        const tableBody = document.getElementById('actividadesTableBody');
        const activeRow = tableBody.querySelector('.table-row-active');
        
        if (activeRow) {
            const inputs = activeRow.querySelectorAll('input');
            const newAct = {
                codigo: inputs[0].value,
                nombre: inputs[1].value,
                fechaCreacion: inputs[2].value,
                fechaModificacion: inputs[3].value,
                creadoPor: inputs[4].value,
                modificadoPor: inputs[5].value
            };
            
            if (!newAct.codigo || !newAct.nombre) {
                showModal('Error', 'Los campos Código y Nombre son obligatorios');
                return;
            }
            
            if (isCreating) {
                actividadesData.unshift(newAct);
                showModal('Éxito', 'Se agregó registro exitosamente');
            } else if (isEditing) {
                actividadesData[selectedActRow] = newAct;
                showModal('Éxito', 'Se modificó registro exitosamente');
            }
            
            localStorage.setItem('actividadesData', JSON.stringify(actividadesData));
            isCreating = false;
            isEditing = false;
            selectedActRow = null;
            renderActividadesTable();
        }
    });

    document.getElementById('backActBtn').addEventListener('click', () => {
        document.getElementById('funcionalidades-tab').click();
    });

    // Manejo del modal
    const messageModal = document.getElementById('messageModal');
    const modalTitle = document.getElementById('modalTitle');
    const modalMessage = document.getElementById('modalMessage');
    const modalCloseBtn = document.getElementById('modalCloseBtn');

    function showModal(title, message) {
        modalTitle.textContent = title;
        modalMessage.innerHTML = message;
        messageModal.classList.remove('hidden');
    }

    modalCloseBtn.addEventListener('click', () => {
        messageModal.classList.add('hidden');
    });

    // Cerrar modal al hacer clic fuera del contenido
    messageModal.addEventListener('click', (e) => {
        if (e.target === messageModal) {
            messageModal.classList.add('hidden');
        }
    });

    // Manejo del modal de búsqueda
    const searchModal = document.getElementById('searchModal');
    const searchModalTitle = document.getElementById('searchModalTitle');
    const searchInput = document.getElementById('searchInput');
    const searchResults = document.getElementById('searchResults');
    const searchModalCloseBtn = document.getElementById('searchModalCloseBtn');
    
    searchModalCloseBtn.addEventListener('click', () => {
        searchModal.classList.add('hidden');
    });

    // Cerrar modal al hacer clic fuera del contenido
    searchModal.addEventListener('click', (e) => {
        if (e.target === searchModal) {
            searchModal.classList.add('hidden');
        }
    });

    // Filtrar resultados de búsqueda
    searchInput.addEventListener('input', () => {
        const searchTerm = searchInput.value.toLowerCase();
        const rows = searchResults.querySelectorAll('tr');
        
        rows.forEach(row => {
            const text = row.textContent.toLowerCase();
            if (text.includes(searchTerm)) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    });

    function setActiveMenu() {
        const currentPath = window.location.pathname.split('/').pop();
        
        document.querySelectorAll('.nav-link[href]').forEach(link => {
            const linkPath = link.getAttribute('href').split('/').pop();
            if (linkPath === currentPath) {
                link.classList.add('active');
            } else {
                link.classList.remove('active');
            }
        });
    }
</script>
</body>
</html>